/*
 * A device API for the s500
 *
 *~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!
 * THIS IS AN AUTOGENERATED FILE
 * DO NOT EDIT
 *~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!~!
 *
 */

#pragma once

#include "ping-device.h"

class S500 : public PingDevice
{
public:
    /**
     *  @brief Constructor
     *
     *  @param ser: The device I/O
     */
    S500(PingPort& port) : PingDevice(port) {}

    /**
     * @brief Destructor
     */
    ~S500();

    /**
     *  @brief Establish communications with the device, and initialize the update interval
     *
     *  @param msec_per_ping: The interval (in milliseconds) between acoustic measurements. -1 for a single ping.
     *
     *  @return true if the device was initialized successfully
     */
    bool initialize(int16_t msec_per_ping = 50);

{% for msg in messages["control"] %}
    /**
     * @brief {{messages["control"][msg].description}}
     *
{% for field in messages["control"][msg].payload %}
     * @param {{field.name}} - {% if field.units %}Units: {{field.units}}; {% endif %}{{field.description}}
{% endfor %}
     *
     * @return when verify = false: true if a valid reply is received from the device.
     * @return when verify = true: true if a valid reply is received from the
     * device, and the values in the reply match the values that we applied
     */
    bool {{msg}}({% for field in messages["control"][msg].payload %}{{generator.get_type_string(field.type)}} {{field.name}}, {% endfor %}bool verify = true);

{% endfor %}

{% for msg in messages["get"]|sort %}
{% if not messages["get"][msg].deprecated %}
    //! {{messages["get"][msg].description}}
    struct {
{% for field in messages["get"][msg].payload %}
        // {{field.description}}
{% if not generator.is_vector(field.type) %}
        {{generator.get_type_string(field.type)}} {{field.name}};
{% else %}
        {{generator.get_type_string(field.vector.datatype)}}* {{field.name}} = nullptr;
        {{generator.get_type_string(field.vector.sizetype)}} {{field.name}}_length = 0;
{% endif %}
{% endfor %}
    } {{msg}}_data;

{% endif %}
{% endfor %}

private:
    /**
     *  @brief Handle an incoming message from the device. Internal values are updated according to the device data.
     *
     *  @param message: A pointer to the message received from the device
     */
    void _handleMessage(const ping_message* message) override;
};
